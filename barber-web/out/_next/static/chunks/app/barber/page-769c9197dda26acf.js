(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[775],{3751:function(e,t,s){Promise.resolve().then(s.bind(s,4940))},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},401:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},1723:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5252:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},292:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]])},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return a.a}});var r=s(2972),a=s.n(r)},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},4940:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var r=s(7437),a=s(2265),i=s(9376),n=s(5526),l=s(2593),c=s(2920),d=s(1047),o=s(5252),u=s(292),x=s(1723),m=s(401);let h=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var g=s(7648);function f(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)(!0),[f,b]=(0,a.useState)(""),[p,v]=(0,a.useState)(null),[y,j]=(0,a.useState)([]),[w,N]=(0,a.useState)({todayBookings:0,monthRevenue:0,totalServices:0});(0,a.useEffect)(()=>{(async()=>{let{data:{user:t}}=await n.O.auth.getUser();if(!t){e.push("/auth");return}let{data:r}=await n.O.from("profiles").select("role, full_name").eq("id",t.id).single();if((null==r?void 0:r.role)!=="barber"&&(null==r?void 0:r.role)!=="admin"){e.push("/dashboard");return}b(r.full_name);let{data:a}=await n.O.from("barbers").select("id").eq("profile_id",t.id).single();if(a){v(a.id);let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()).toISOString(),s=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1).toISOString(),{data:r}=await n.O.from("bookings").select("\n            id, start_time, end_time, status,\n            service:services(name, price),\n            client:profiles!bookings_client_id_fkey(full_name)\n          ").eq("barber_id",a.id).gte("start_time",t).lt("start_time",s).order("start_time"),i=(r||[]).map(e=>({...e,service:Array.isArray(e.service)?e.service[0]||null:e.service,client:Array.isArray(e.client)?e.client[0]||null:e.client}));j(i);let l=new Date(e.getFullYear(),e.getMonth(),1).toISOString(),{data:c}=await n.O.from("bookings").select("service:services(price)").eq("barber_id",a.id).eq("status","completed").gte("start_time",l),d=(c||[]).reduce((e,t)=>{var s;return e+(Array.isArray(t.service)&&(null===(s=t.service[0])||void 0===s?void 0:s.price)||0)},0),{count:o}=await n.O.from("services").select("*",{count:"exact"}).eq("barber_id",a.id).eq("is_active",!0);N({todayBookings:(null==i?void 0:i.length)||0,monthRevenue:d,totalServices:o||0})}s(!1)})()},[e]);let k=async(e,t)=>{await n.O.from("bookings").update({status:t}).eq("id",e),j(y.map(s=>s.id===e?{...s,status:t}:s))};return t?(0,r.jsx)("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center text-gold",children:"Carregando Painel do Barbeiro..."}):(0,r.jsx)("div",{className:"min-h-screen bg-dark-bg p-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("header",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["Ol\xe1, ",f]}),(0,r.jsx)("p",{className:"text-gray-400",children:"Gerencie sua agenda e servi\xe7os"})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(g.default,{href:"/barber/schedule",children:(0,r.jsx)(c.g,{className:"w-auto bg-white/10 border border-white/20 text-white hover:bg-white/20",children:"Hor\xe1rios"})}),(0,r.jsx)(g.default,{href:"/barber/services",children:(0,r.jsx)(c.g,{className:"w-auto",children:"Meus Servi\xe7os"})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsx)(l.W,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,r.jsx)("div",{className:"bg-blue-500/20 p-3 rounded-full text-blue-400",children:(0,r.jsx)(d.Z,{className:"w-6 h-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Agendamentos Hoje"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:w.todayBookings})]})]})}),(0,r.jsx)(l.W,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,r.jsx)("div",{className:"bg-green-500/20 p-3 rounded-full text-green-400",children:(0,r.jsx)(o.Z,{className:"w-6 h-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Faturamento M\xeas"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-white",children:["R$ ",w.monthRevenue.toFixed(0)]})]})]})}),(0,r.jsx)(l.W,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,r.jsx)("div",{className:"bg-gold/20 p-3 rounded-full text-gold",children:(0,r.jsx)(u.Z,{className:"w-6 h-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Servi\xe7os Ativos"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:w.totalServices})]})]})})]}),(0,r.jsxs)(l.W,{className:"p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[(0,r.jsx)(x.Z,{className:"text-gold"})," Pr\xf3ximos Clientes"]}),(0,r.jsx)("div",{className:"space-y-4",children:0===y.length?(0,r.jsx)("p",{className:"text-gray-400 text-center py-8",children:"Nenhum agendamento para hoje"}):y.map(e=>{var t,s;let a=new Date(e.start_time).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});return(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg border border-white/5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gold font-bold",children:a}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Hoje"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:(null===(t=e.client)||void 0===t?void 0:t.full_name)||"Cliente"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:(null===(s=e.service)||void 0===s?void 0:s.name)||"Servi\xe7o"})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:"pending"===e.status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>k(e.id,"confirmed"),className:"p-2 rounded-lg bg-green-500/20 text-green-400 hover:bg-green-500/30",children:(0,r.jsx)(m.Z,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>k(e.id,"cancelled"),className:"p-2 rounded-lg bg-red-500/20 text-red-400 hover:bg-red-500/30",children:(0,r.jsx)(h,{className:"w-4 h-4"})})]}):(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs ".concat("confirmed"===e.status?"bg-green-500/20 text-green-400":"cancelled"===e.status?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"),children:"confirmed"===e.status?"Confirmado":"cancelled"===e.status?"Cancelado":e.status})})]},e.id)})})]})]})})}},2593:function(e,t,s){"use strict";s.d(t,{W:function(){return i}});var r=s(7437),a=s(3448);function i(e){let{children:t,className:s,...i}=e;return(0,r.jsx)("div",{className:(0,a.cn)("backdrop-blur-md bg-white/10 border border-white/20 rounded-xl shadow-xl",s),...i,children:t})}},2920:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var r=s(7437),a=s(3448);let i=(0,s(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function n(e){let{children:t,className:s,isLoading:n,disabled:l,...c}=e;return(0,r.jsxs)("button",{disabled:l||n,className:(0,a.cn)("w-full bg-gradient-to-r from-[#D4AF37] to-[#F2D06B] text-black font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-gold/50 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",s),...c,children:[n&&(0,r.jsx)(i,{className:"mr-2 h-4 w-4 animate-spin"}),t]})}},5526:function(e,t,s){"use strict";s.d(t,{O:function(){return r}});let r=(0,s(1695).createBrowserClient)("https://zynmvmxdluevuwigbadz.supabase.co","sb_publishable_9w0K7O3Sun2zl2qIQwX33g_wGkVsy6f")},3448:function(e,t,s){"use strict";s.d(t,{cn:function(){return i}});var r=s(1994),a=s(3335);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}}},function(e){e.O(0,[554,695,972,971,117,744],function(){return e(e.s=3751)}),_N_E=e.O()}]);